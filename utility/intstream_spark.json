{"paragraphs":[{"text":"%pyspark\nfor x in range(100):\n    print x","user":"anonymous","dateUpdated":"2020-01-29T03:01:45+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n33\n34\n35\n36\n37\n38\n39\n40\n41\n42\n43\n44\n45\n46\n47\n48\n49\n50\n51\n52\n53\n54\n55\n56\n57\n58\n59\n60\n61\n62\n63\n64\n65\n66\n67\n68\n69\n70\n71\n72\n73\n74\n75\n76\n77\n78\n79\n80\n81\n82\n83\n84\n85\n86\n87\n88\n89\n90\n91\n92\n93\n94\n95\n96\n97\n98\n99\n"}]},"apps":[],"jobName":"paragraph_1580266032964_-1785540259","id":"20200127-011156_1752161810","dateCreated":"2020-01-29T02:47:12+0000","dateStarted":"2020-01-29T03:01:47+0000","dateFinished":"2020-01-29T03:05:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4197"},{"text":"%pyspark\nsc","user":"anonymous","dateUpdated":"2020-01-29T03:01:49+0000","config":{"colWidth":12,"fontSize":9,"results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<SparkContext master=yarn appName=Zeppelin>\n"}]},"apps":[],"jobName":"paragraph_1580266033074_154940284","id":"20200127-011225_1121116829","dateCreated":"2020-01-29T02:47:13+0000","dateStarted":"2020-01-29T03:05:16+0000","dateFinished":"2020-01-29T03:05:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4198"},{"text":"%pyspark\nrdd = sc.wholeTextFiles(\"s3://intstream-train-upload/intstream-1.20200128.212642.544272/data/\")","user":"anonymous","dateUpdated":"2020-01-29T03:01:50+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580266033103_-1882263412","id":"20200127-011359_750823026","dateCreated":"2020-01-29T02:47:13+0000","dateStarted":"2020-01-29T03:05:16+0000","dateFinished":"2020-01-29T03:05:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4199"},{"text":"%pyspark\ndfWithSchema = spark.createDataFrame(rdd).toDF(\"file\", \"text\")","user":"anonymous","dateUpdated":"2020-01-29T03:01:52+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580266033111_-669376036","id":"20200127-012917_1708905323","dateCreated":"2020-01-29T02:47:13+0000","dateStarted":"2020-01-29T03:05:17+0000","dateFinished":"2020-01-29T03:05:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4200"},{"text":"%pyspark\ndfWithSchema.show()","user":"anonymous","dateUpdated":"2020-01-29T03:01:54+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+\n|                file|                text|\n+--------------------+--------------------+\n|s3://intstream-tr...|architecture -  n...|\n+--------------------+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1580266033112_-1541824446","id":"20200127-013205_707112177","dateCreated":"2020-01-29T02:47:13+0000","dateStarted":"2020-01-29T03:05:17+0000","dateFinished":"2020-01-29T03:05:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4201"},{"text":"%pyspark\ntargets = spark.read.json(\"s3://intstream-train-upload/intstream-1.20200128.212642.544272/targets.json\") ","user":"anonymous","dateUpdated":"2020-01-29T03:01:37+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580266033113_2035553942","id":"20200127-014511_756734531","dateCreated":"2020-01-29T02:47:13+0000","dateStarted":"2020-01-29T03:01:37+0000","dateFinished":"2020-01-29T03:05:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4202"},{"text":"%pyspark\ntargets.show()","user":"anonymous","dateUpdated":"2020-01-29T03:05:55+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+---+-------+------------+------+\n|article| id|mlmodel|organization|target|\n+-------+---+-------+------------+------+\n|    393|  8|      1|           1| false|\n+-------+---+-------+------------+------+\n\n"}]},"apps":[],"jobName":"paragraph_1580266897272_-156643212","id":"20200129-030137_1599740478","dateCreated":"2020-01-29T03:01:37+0000","dateStarted":"2020-01-29T03:05:55+0000","dateFinished":"2020-01-29T03:05:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4203"},{"text":"%pyspark\ndfWithSchema.select(\"file\").show()","user":"anonymous","dateUpdated":"2020-01-29T03:09:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                file|\n+--------------------+\n|s3://intstream-tr...|\n+--------------------+\n\n"}]},"apps":[],"jobName":"paragraph_1580267145886_-774925690","id":"20200129-030545_775975693","dateCreated":"2020-01-29T03:05:45+0000","dateStarted":"2020-01-29T03:09:09+0000","dateFinished":"2020-01-29T03:09:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4204"},{"text":"%pyspark\nfrom pyspark.sql.functions import substring_index, col\nres = dfWithSchema.select(col(\"*\"), substring_index(col(\"file\"), \"/\", -1).alias(\"id\"))","user":"anonymous","dateUpdated":"2020-01-29T03:39:26+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1580267349314_1105364998","id":"20200129-030909_959860390","dateCreated":"2020-01-29T03:09:09+0000","dateStarted":"2020-01-29T03:39:27+0000","dateFinished":"2020-01-29T03:39:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4205"},{"text":"%pyspark\nres.show()","user":"anonymous","dateUpdated":"2020-01-29T03:39:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+--------------------+---+\n|                file|                text| id|\n+--------------------+--------------------+---+\n|s3://intstream-tr...|architecture -  n...|578|\n+--------------------+--------------------+---+\n\n"}]},"apps":[],"jobName":"paragraph_1580267974864_1435854900","id":"20200129-031934_1851516163","dateCreated":"2020-01-29T03:19:34+0000","dateStarted":"2020-01-29T03:39:29+0000","dateFinished":"2020-01-29T03:39:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4206"},{"text":"%pyspark\njoined = res.join(targets, res.id==targets.article)","user":"anonymous","dateUpdated":"2020-01-29T03:58:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1580268592414_1548624127","id":"20200129-032952_557201113","dateCreated":"2020-01-29T03:29:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4207","dateFinished":"2020-01-29T03:58:32+0000","dateStarted":"2020-01-29T03:58:32+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2020-01-29T03:56:00+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1580270160919_-513553655","id":"20200129-035600_1235582651","dateCreated":"2020-01-29T03:56:00+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5123"}],"name":"intstream_spark","id":"2EZ55AZP5","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}